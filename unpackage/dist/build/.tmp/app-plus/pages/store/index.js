(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/store/index"],{"01ed":function(t,e,n){"use strict";var a=n("7b1d"),i=n.n(a);i.a},"05e6":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n("a34a")),i=r(n("0642")),s=r(n("b775")),o=n("e4e4");function r(t){return t&&t.__esModule?t:{default:t}}function c(t,e,n,a,i,s,o){try{var r=t[s](o),c=r.value}catch(l){return void n(l)}r.done?e(c):Promise.resolve(c).then(a,i)}function l(t){return function(){var e=this,n=arguments;return new Promise(function(a,i){var s=t.apply(e,n);function o(t){c(s,a,i,o,r,"next",t)}function r(t){c(s,a,i,o,r,"throw",t)}o(void 0)})}}var u={components:{dividLine:i.default,scrollIndex:s.default},data:function(){return{uni:"",swiper:"",tab:"",scrolltop:0,productList:new Array(10),loadingType:0,imagelist:[{title:1,src:"https://img.alicdn.com/tps/i4/TB1yNlhhAvoK1RjSZFwSuwiCFXa.jpg_q90_.webp"},{title:2,src:"https://aecpm.alicdn.com/simba/img/TB1JNHwKFXXXXafXVXXSutbFXXX.jpg"},{title:3,src:"https://aecpm.alicdn.com/simba/img/TB1XotJXQfb_uJkSnhJSuvdDVXa.jpg"},{title:3,src:"https://aecpm.alicdn.com/simba/img/TB1XotJXQfb_uJkSnhJSuvdDVXa.jpg"},{title:3,src:"https://aecpm.alicdn.com/simba/img/TB1XotJXQfb_uJkSnhJSuvdDVXa.jpg"}],duration:300,loadingText:{contentrefresh:"正在加载...",contentnomore:"没有更多数据了"},scrollLeft:0,istapChange:!1,tabIndex:0,productMap:new Map,count:0,tabBars:[{name:"全部",id:"zb"},{name:"百货",id:"bh"},{name:"女装",id:"nz"}]}},onLoad:function(t){this._getData()},methods:{qrcode:function(){console.log("二维码"),t.scanCode({success:function(e){console.log("条码类型："+e.scanType),console.log("条码内容："+e.result),t.navigateTo({url:"/pages/common/web-view?src=".concat(e.result)})}})},_getData:function(){var e=this;t.showLoading({title:"加载中..",mask:!0});var n=Promise.all([(0,o.getRecommend)(),(0,o.getHotListGood)(),(0,o.getGoodsList)({page:0,type:"",screen:"",jg:""})]);n.then(function(n){if(console.log("aa",n),t.hideLoading(),n.length){var a=!0,i=!1,s=void 0;try{for(var o,r=n[Symbol.iterator]();!(a=(o=r.next()).done);a=!0){var c=o.value;if(200!=c.code)return void e._showError()}}catch(l){i=!0,s=l}finally{try{a||null==r.return||r.return()}finally{if(i)throw s}}e.productList.splice(e.tabIndex,1,{hotGood:n[1].result,banner:e.imagelist,msg:n[0].result,product:n[2].result}),t.setStorageSync(e.tabIndex.toString(),e.productList[e.tabIndex]),console.log("第一次加载数据",e.productList)}})},godetail:function(e){t.navigateTo({url:"/pages/common/goods-detail?id=".concat(e,"&table=yhq_goods")}),this.globScrollTop=this.nowScroll},_showError:function(){t.showToast({title:"出错了...",icon:"none",mask:!0})},_getGoodsList:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";t.showLoading({title:"加载中.."}),(0,o.getGoodsList)({page:n,type:a,screen:i,jg:s}).then(function(n){t.hideLoading(),200==n.code?(e.productList.splice(e.tabIndex,1,{banner:e.imagelist,msg:"",product:n.result}),t.setStorageSync(e.tabIndex.toString(),e.productList[e.tabIndex])):e._showError()})},jump:function(e){if(this.globScrollTop=this.nowScroll,"search"!=e){var n=(new Map).set("jhs","聚划算").set("by","9.9包邮").set("tqg","淘抢购").set("tj","每日精选").set("tmjx","天猫精选");t.navigateTo({url:"/pages/common/good-item?type=".concat(e,"&title=").concat(n.get(e))})}else t.switchTab({url:"/pages/common/search"})},changeTab:function(){var e=l(a.default.mark(function e(n){var i,s,o,r,c,l,u,d,p,b;return a.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(i=n.target.current,console.log("切换tab",i),0==i?"":this.tabBars[i].name,!this.istapChange){e.next=7;break}return this.tabIndex=i,this.istapChange=!1,e.abrupt("return");case 7:return e.next=9,this.getElSize("tab-bar");case 9:s=e.sent,o=s.scrollLeft,r=0,c=0;case 13:if(!(c<i)){e.next=21;break}return e.next=16,this.getElSize(this.tabBars[c].id);case 16:l=e.sent,r+=l.width;case 18:c++,e.next=13;break;case 21:return u=t.getSystemInfoSync().windowWidth,e.next=24,this.getElSize(this.tabBars[i].id);case 24:if(d=e.sent,p=d.width,r+p-o>u&&(this.scrollLeft=r+p-u),r<o&&(this.scrollLeft=r),this.istapChange=!1,this.tabIndex=i,this.loadingType=0,b=null,console.log("当前tab是否有数据",this.productList[this.tabIndex]),!this.productList[this.tabIndex])try{b=t.getStorageSync(this.tabIndex.toString()),console.log("从缓存获取数据",this.tabIndex,b),b?this.productList.splice(this.tabIndex,1,b):this._getGoodsList("",this.tabBars[this.tabIndex].name,"","")}catch(n){console.log("getData",n.message)}case 34:case"end":return e.stop()}},e,this)}));function n(t){return e.apply(this,arguments)}return n}(),getElSize:function(e){return new Promise(function(n,a){t.createSelectorQuery().select("#"+e).fields({size:!0,scrollOffset:!0},function(t){n(t)}).exec()})},tapTab:function(){var t=l(a.default.mark(function t(e){var n,i,s;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("tabbar",e),this.tabIndex!==e.target.dataset.current){t.next=5;break}return t.abrupt("return",!1);case 5:return n=e.target.dataset.current,console.log(n,this.tabBars[n]),0==n?"":this.tabBars[n].name,t.next=10,this.getElSize("tab-bar");case 10:i=t.sent,s=i.scrollLeft,this.scrollLeft=s,this.istapChange=!0,this.tabIndex=e.target.dataset.current,this.loadingType=0;case 16:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()}};e.default=u}).call(this,n("649d")["default"])},"4e7b":function(t,e,n){"use strict";n.r(e);var a=n("dc02"),i=n("9ab0");for(var s in i)"default"!==s&&function(t){n.d(e,t,function(){return i[t]})}(s);n("01ed");var o=n("2877"),r=Object(o["a"])(i["default"],a["a"],a["b"],!1,null,"6e74f6a9",null);r.options.__file="index.vue",e["default"]=r.exports},"7b1d":function(t,e,n){},"9ab0":function(t,e,n){"use strict";n.r(e);var a=n("05e6"),i=n.n(a);for(var s in a)"default"!==s&&function(t){n.d(e,t,function(){return a[t]})}(s);e["default"]=i.a},"9bd4":function(t,e,n){"use strict";n("95b2");var a=s(n("b0ce")),i=s(n("4e7b"));function s(t){return t&&t.__esModule?t:{default:t}}Page((0,a.default)(i.default))},dc02:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("view",{staticClass:"index-content"},[t._m(0),n("view",{staticClass:"uni-tab-bar uni-swiper-tab"},[n("scroll-view",{staticClass:"_isfixed ",attrs:{id:"tab-bar","scroll-x":"","scroll-left":t.scrollLeft}},t._l(t.tabBars,function(e,a){return n("view",{key:e.id,class:["swiper-tab-list",t.tabIndex==a?"active":""],attrs:{id:e.id,"data-current":a,eventid:"535b1492-0-"+a},on:{tap:t.tapTab}},[t._v(t._s(e.name))])})),n("swiper",{staticClass:"index-swiper",attrs:{current:t.tabIndex,circular:"",eventid:"535b1492-1"},on:{change:t.changeTab}},[n("swiper-item",{attrs:{mpcomid:"535b1492-1"}},[n("block",[t.productList[0]?n("scroll-index",{attrs:{productgood:t.productList[0],current:"1",type:t.tabBars[0].name,isgood:!0,mpcomid:"535b1492-0"}}):t._e()],1)],1),n("swiper-item",{attrs:{mpcomid:"535b1492-3"}},[n("block",[t.productList[1]?n("scroll-index",{attrs:{productgood:t.productList[1],current:"2",type:t.tabBars[1].name,isgood:!0,mpcomid:"535b1492-2"}}):t._e()],1)],1),n("swiper-item",{attrs:{mpcomid:"535b1492-5"}},[n("block",[t.productList[2]?n("scroll-index",{attrs:{productgood:t.productList[2],current:"3",type:t.tabBars[2].name,isgood:!0,mpcomid:"535b1492-4"}}):t._e()],1)],1)],1)],1)])},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("view",{staticClass:"search-container"},[n("view",{staticClass:"title"},[t._v("商城")])])}];n.d(e,"a",function(){return a}),n.d(e,"b",function(){return i})}},[["9bd4","common/runtime","common/vendor"]]]);